(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     23965,        787]
NotebookOptionsPosition[     22586,        735]
NotebookOutlinePosition[     22934,        750]
CellTagsIndexPosition[     22891,        747]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell["\<\
Integral of x*mu(x) in colossus conventions or x/g(x) in Lokas 2001 \
conventions\
\>", "Text",
 CellChangeTimes->{{3.833653529049635*^9, 3.83365355082621*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubsuperscriptBox["\[Integral]", "0", "R"], 
  RowBox[{"x", "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Log", "[", 
      RowBox[{"1", " ", "+", " ", "x"}], "]"}], " ", "-", " ", 
     FractionBox["x", 
      RowBox[{"1", " ", "+", " ", "x"}]]}], ")"}], 
   RowBox[{"\[DifferentialD]", "x"}]}]}]], "Input",
 CellChangeTimes->{{3.833604964474614*^9, 3.83360508662892*^9}}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{
   RowBox[{
    FractionBox["1", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "3"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "2"}], "+", "R"}], ")"}], " ", "R"}], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "3"}], "+", 
         SuperscriptBox["R", "2"]}], ")"}], " ", 
       RowBox[{"Log", "[", 
        RowBox[{"1", "+", "R"}], "]"}]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"Re", "[", "R", "]"}], ">", 
     RowBox[{"-", "1"}]}], "||", 
    RowBox[{"R", "\[NotElement]", "Reals"}]}]}], "]"}]], "Output",
 CellChangeTimes->{{3.833605066100107*^9, 3.833605093628488*^9}}]
}, Open  ]],

Cell["Finding the potential for the NFW profile", "Text",
 CellChangeTimes->{{3.833653493747311*^9, 3.833653499753768*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "4"}], " ", "\[Pi]", " ", "G", " ", 
  FractionBox["1", "R"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SubsuperscriptBox["\[Integral]", "0", "R"], 
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      FractionBox[
       SubscriptBox["\[Rho]", "rs"], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r", "/", 
          SubscriptBox["r", "s"]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"r", "/", 
            SubscriptBox["r", "s"]}]}], ")"}], "2"]}]], 
      RowBox[{"\[DifferentialD]", "r"}]}]}], " ", "+", " ", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "R", "\[Infinity]"], 
     RowBox[{"r", " ", 
      FractionBox[
       SubscriptBox["\[Rho]", "rs"], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"r", "/", 
          SubscriptBox["r", "s"]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"r", "/", 
            SubscriptBox["r", "s"]}]}], ")"}], "2"]}]], 
      RowBox[{"\[DifferentialD]", "r"}]}]}]}], " ", ")"}]}]], "Input",
 CellChangeTimes->{{3.833652068113144*^9, 3.833652204131879*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"4", " ", "G", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubsuperscriptBox["\[Integral]", "R", "\[Infinity]"], 
       RowBox[{
        FractionBox[
         RowBox[{
          SubscriptBox["r", "s"], " ", 
          SubscriptBox["\[Rho]", "rs"]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SubscriptBox["r", "s"]]}], ")"}], "2"]], 
        RowBox[{"\[DifferentialD]", "r"}]}]}], "+", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", "R"], 
       RowBox[{
        FractionBox[
         RowBox[{"r", " ", 
          SubscriptBox["r", "s"], " ", 
          SubscriptBox["\[Rho]", "rs"]}], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            FractionBox["r", 
             SubscriptBox["r", "s"]]}], ")"}], "2"]], 
        RowBox[{"\[DifferentialD]", "r"}]}]}]}], ")"}]}], "R"]}]], "Output",
 CellChangeTimes->{3.833652206026683*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "4"}], " ", "\[Pi]", " ", "G", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     FractionBox["1", "R"], " ", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "R"], 
      RowBox[{
       SuperscriptBox["x", "2"], " ", 
       FractionBox[
        SubscriptBox["\[Rho]", "rs"], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"x", "/", 
           SubscriptBox["r", "s"]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"x", "/", 
             SubscriptBox["r", "s"]}]}], ")"}], "2"]}]], 
       RowBox[{"\[DifferentialD]", "x"}]}]}]}], " ", "+", " ", 
    RowBox[{
     SubsuperscriptBox["\[Integral]", "R", "\[Infinity]"], 
     RowBox[{"x", " ", 
      FractionBox[
       SubscriptBox["\[Rho]", "rs"], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"x", "/", 
          SubscriptBox["r", "s"]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"x", "/", 
            SubscriptBox["r", "s"]}]}], ")"}], "2"]}]], 
      RowBox[{"\[DifferentialD]", "x"}]}]}]}], " ", ")"}]}]], "Input",
 CellChangeTimes->{{3.833652299682597*^9, 3.833652327811438*^9}, {
  3.833652846741384*^9, 3.833652853392268*^9}}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "4"}], " ", "G", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubsuperscriptBox["r", "s", "3"], " ", 
        SubscriptBox["\[Rho]", "rs"]}], 
       RowBox[{"R", "+", 
        SubscriptBox["r", "s"]}]], "+", 
      FractionBox[
       RowBox[{
        SubsuperscriptBox["r", "s", "3"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"Log", "[", 
            SubscriptBox["r", "s"], "]"}]}], "+", 
          RowBox[{"Log", "[", 
           RowBox[{"R", "+", 
            SubscriptBox["r", "s"]}], "]"}], "-", 
          FractionBox["R", 
           RowBox[{"R", "+", 
            SubscriptBox["r", "s"]}]]}], ")"}], " ", 
        SubscriptBox["\[Rho]", "rs"]}], "R"]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox[
        SubscriptBox["r", "s"], "R"], "\[NotElement]", "Reals"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Re", "[", 
          FractionBox[
           SubscriptBox["r", "s"], "R"], "]"}], "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{
         FractionBox[
          SubscriptBox["r", "s"], "R"], "\[NotEqual]", "0"}]}], ")"}], "||", 
      RowBox[{
       RowBox[{"Re", "[", 
        FractionBox[
         SubscriptBox["r", "s"], "R"], "]"}], "<", 
       RowBox[{"-", "1"}]}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Im", "[", "R", "]"}], "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"Im", "[", 
          SubscriptBox["r", "s"], "]"}], "\[GreaterEqual]", "0"}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Im", "[", "R", "]"}], "\[LessEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"Im", "[", 
          SubscriptBox["r", "s"], "]"}], "\[LessEqual]", "0"}]}], ")"}], "||", 
      RowBox[{
       FractionBox[
        RowBox[{"Im", "[", 
         SubscriptBox["r", "s"], "]"}], 
        RowBox[{"Im", "[", "R", "]"}]], "\[LessEqual]", 
       RowBox[{"-", "1"}]}], "||", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"Im", "[", 
          SubscriptBox["r", "s"], "]"}], " ", 
         RowBox[{"Re", "[", "R", "]"}]}], 
        RowBox[{"Im", "[", "R", "]"}]], "\[LessEqual]", 
       RowBox[{"Re", "[", 
        SubscriptBox["r", "s"], "]"}]}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Im", "[", 
         SubscriptBox["r", "s"], "]"}], " ", 
        RowBox[{"Re", "[", "R", "]"}]}], "\[NotEqual]", 
       RowBox[{
        RowBox[{"Im", "[", "R", "]"}], " ", 
        RowBox[{"Re", "[", 
         SubscriptBox["r", "s"], "]"}]}]}], "||", 
      RowBox[{
       RowBox[{"R", "+", 
        SubscriptBox["r", "s"]}], ">", "0"}], "||", 
      RowBox[{"R", "\[NotElement]", "Reals"}], "||", 
      RowBox[{
       RowBox[{"R", "+", 
        SubscriptBox["r", "s"]}], "\[NotElement]", "Reals"}]}], ")"}]}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.833652314678817*^9, 3.83365235038922*^9, 
  3.833652872727449*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"ConditionalExpression", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], " ", "G", " ", "\[Pi]", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SubsuperscriptBox["r", "s", "3"], " ", 
         SubscriptBox["\[Rho]", "rs"]}], 
        RowBox[{"R", "+", 
         SubscriptBox["r", "s"]}]], "+", 
       FractionBox[
        RowBox[{
         SubsuperscriptBox["r", "s", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Log", "[", 
             SubscriptBox["r", "s"], "]"}]}], "+", 
           RowBox[{"Log", "[", 
            RowBox[{"R", "+", 
             SubscriptBox["r", "s"]}], "]"}], "-", 
           FractionBox["R", 
            RowBox[{"R", "+", 
             SubscriptBox["r", "s"]}]]}], ")"}], " ", 
         SubscriptBox["\[Rho]", "rs"]}], "R"]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox[
         SubscriptBox["r", "s"], "R"], "\[NotElement]", "Reals"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Re", "[", 
           FractionBox[
            SubscriptBox["r", "s"], "R"], "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          FractionBox[
           SubscriptBox["r", "s"], "R"], "\[NotEqual]", "0"}]}], ")"}], "||", 
       
       RowBox[{
        RowBox[{"Re", "[", 
         FractionBox[
          SubscriptBox["r", "s"], "R"], "]"}], "<", 
        RowBox[{"-", "1"}]}]}], ")"}], "&&", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "R", "]"}], "\[GreaterEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"Im", "[", 
           SubscriptBox["r", "s"], "]"}], "\[GreaterEqual]", "0"}]}], ")"}], "||", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Im", "[", "R", "]"}], "\[LessEqual]", "0"}], "&&", 
         RowBox[{
          RowBox[{"Im", "[", 
           SubscriptBox["r", "s"], "]"}], "\[LessEqual]", "0"}]}], ")"}], "||", 
       RowBox[{
        FractionBox[
         RowBox[{"Im", "[", 
          SubscriptBox["r", "s"], "]"}], 
         RowBox[{"Im", "[", "R", "]"}]], "\[LessEqual]", 
        RowBox[{"-", "1"}]}], "||", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"Im", "[", 
           SubscriptBox["r", "s"], "]"}], " ", 
          RowBox[{"Re", "[", "R", "]"}]}], 
         RowBox[{"Im", "[", "R", "]"}]], "\[LessEqual]", 
        RowBox[{"Re", "[", 
         SubscriptBox["r", "s"], "]"}]}]}], ")"}], "&&", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Im", "[", 
          SubscriptBox["r", "s"], "]"}], " ", 
         RowBox[{"Re", "[", "R", "]"}]}], "\[NotEqual]", 
        RowBox[{
         RowBox[{"Im", "[", "R", "]"}], " ", 
         RowBox[{"Re", "[", 
          SubscriptBox["r", "s"], "]"}]}]}], "||", 
       RowBox[{
        RowBox[{"R", "+", 
         SubscriptBox["r", "s"]}], ">", "0"}], "||", 
       RowBox[{"R", "\[NotElement]", "Reals"}], "||", 
       RowBox[{
        RowBox[{"R", "+", 
         SubscriptBox["r", "s"]}], "\[NotElement]", "Reals"}]}], ")"}]}]}], 
   "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.833652374391563*^9, 3.833652383997016*^9}, {
  3.83365290502884*^9, 3.833652906619048*^9}}],

Cell[BoxData[
 RowBox[{"ConditionalExpression", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"4", " ", "G", " ", "\[Pi]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Log", "[", 
        SubscriptBox["r", "s"], "]"}], "-", 
       RowBox[{"Log", "[", 
        RowBox[{"R", "+", 
         SubscriptBox["r", "s"]}], "]"}]}], ")"}], " ", 
     SubsuperscriptBox["r", "s", "3"], " ", 
     SubscriptBox["\[Rho]", "rs"]}], "R"], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       FractionBox[
        SubscriptBox["r", "s"], "R"], "\[NotElement]", "Reals"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Re", "[", 
          FractionBox[
           SubscriptBox["r", "s"], "R"], "]"}], "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{
         FractionBox[
          SubscriptBox["r", "s"], "R"], "\[NotEqual]", "0"}]}], ")"}], "||", 
      RowBox[{
       RowBox[{"Re", "[", 
        FractionBox[
         SubscriptBox["r", "s"], "R"], "]"}], "<", 
       RowBox[{"-", "1"}]}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Im", "[", "R", "]"}], "\[GreaterEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"Im", "[", 
          SubscriptBox["r", "s"], "]"}], "\[GreaterEqual]", "0"}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Im", "[", "R", "]"}], "\[LessEqual]", "0"}], "&&", 
        RowBox[{
         RowBox[{"Im", "[", 
          SubscriptBox["r", "s"], "]"}], "\[LessEqual]", "0"}]}], ")"}], "||", 
      RowBox[{
       FractionBox[
        RowBox[{"Im", "[", 
         SubscriptBox["r", "s"], "]"}], 
        RowBox[{"Im", "[", "R", "]"}]], "\[LessEqual]", 
       RowBox[{"-", "1"}]}], "||", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"Im", "[", 
          SubscriptBox["r", "s"], "]"}], " ", 
         RowBox[{"Re", "[", "R", "]"}]}], 
        RowBox[{"Im", "[", "R", "]"}]], "\[LessEqual]", 
       RowBox[{"Re", "[", 
        SubscriptBox["r", "s"], "]"}]}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Im", "[", 
         SubscriptBox["r", "s"], "]"}], " ", 
        RowBox[{"Re", "[", "R", "]"}]}], "\[NotEqual]", 
       RowBox[{
        RowBox[{"Im", "[", "R", "]"}], " ", 
        RowBox[{"Re", "[", 
         SubscriptBox["r", "s"], "]"}]}]}], "||", 
      RowBox[{
       RowBox[{"R", "+", 
        SubscriptBox["r", "s"]}], ">", "0"}], "||", 
      RowBox[{"R", "\[NotElement]", "Reals"}], "||", 
      RowBox[{
       RowBox[{"R", "+", 
        SubscriptBox["r", "s"]}], "\[NotElement]", "Reals"}]}], ")"}]}]}], 
  "]"}]], "Output",
 CellChangeTimes->{3.833652385125643*^9, 3.833652907711282*^9}]
}, Open  ]],

Cell["\<\
Need the gradient of the potential d\[Phi]/dr. Verified against finite \
differences.\
\>", "Text",
 CellChangeTimes->{{3.833653570704657*^9, 3.833653574018744*^9}, {
  3.834757720711278*^9, 3.8347577421663*^9}, {3.8347588784884253`*^9, 
  3.834758882919303*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Phi]", "[", "r_", "]"}], ":=", 
  RowBox[{"4", " ", "\[Pi]", " ", "G", " ", 
   SuperscriptBox[
    SubscriptBox["R", "s"], "3"], " ", 
   SubscriptBox["\[Rho]", "s"], " ", 
   FractionBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Log", "[", 
       SubscriptBox["R", "s"], "]"}], " ", "-", " ", 
      RowBox[{"Log", "[", 
       RowBox[{"r", "+", 
        SubscriptBox["R", "s"]}], "]"}]}], ")"}], 
    "r"]}]}], "\[IndentingNewLine]", 
 RowBox[{"D", "[", 
  RowBox[{
   RowBox[{"\[Phi]", "[", "r", "]"}], ",", "r"}], "]"}]}], "Input",
 CellChangeTimes->{{3.834757763681343*^9, 3.834757849991344*^9}, {
  3.83475794161511*^9, 3.834757973074478*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"4", " ", "G", " ", "\[Pi]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Log", "[", 
        SubscriptBox["R", "s"], "]"}], "-", 
       RowBox[{"Log", "[", 
        RowBox[{"r", "+", 
         SubscriptBox["R", "s"]}], "]"}]}], ")"}], " ", 
     SubsuperscriptBox["R", "s", "3"], " ", 
     SubscriptBox["\[Rho]", "s"]}], 
    SuperscriptBox["r", "2"]]}], "-", 
  FractionBox[
   RowBox[{"4", " ", "G", " ", "\[Pi]", " ", 
    SubsuperscriptBox["R", "s", "3"], " ", 
    SubscriptBox["\[Rho]", "s"]}], 
   RowBox[{"r", " ", 
    RowBox[{"(", 
     RowBox[{"r", "+", 
      SubscriptBox["R", "s"]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.8347579691309443`*^9, 3.8347579735409727`*^9}, 
   3.8683897987931905`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]", "'"}], "[", "r", "]"}]], "Input",
 CellChangeTimes->{{3.834757979925848*^9, 3.834757988045723*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"4", " ", "G", " ", "\[Pi]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Log", "[", 
        SubscriptBox["R", "s"], "]"}], "-", 
       RowBox[{"Log", "[", 
        RowBox[{"r", "+", 
         SubscriptBox["R", "s"]}], "]"}]}], ")"}], " ", 
     SubsuperscriptBox["R", "s", "3"], " ", 
     SubscriptBox["\[Rho]", "s"]}], 
    SuperscriptBox["r", "2"]]}], "-", 
  FractionBox[
   RowBox[{"4", " ", "G", " ", "\[Pi]", " ", 
    SubsuperscriptBox["R", "s", "3"], " ", 
    SubscriptBox["\[Rho]", "s"]}], 
   RowBox[{"r", " ", 
    RowBox[{"(", 
     RowBox[{"r", "+", 
      SubscriptBox["R", "s"]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{3.834757989124693*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"4", " ", "G", " ", "\[Pi]", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Log", "[", 
         SubscriptBox["R", "s"], "]"}], "-", 
        RowBox[{"Log", "[", 
         RowBox[{"r", "+", 
          SubscriptBox["R", "s"]}], "]"}]}], ")"}], " ", 
      SubsuperscriptBox["R", "s", "3"], " ", 
      SubscriptBox["\[Rho]", "s"]}], 
     SuperscriptBox["r", "2"]]}], "-", 
   FractionBox[
    RowBox[{"4", " ", "G", " ", "\[Pi]", " ", 
     SubsuperscriptBox["R", "s", "3"], " ", 
     SubscriptBox["\[Rho]", "s"]}], 
    RowBox[{"r", " ", 
     RowBox[{"(", 
      RowBox[{"r", "+", 
       SubscriptBox["R", "s"]}], ")"}]}]]}], "]"}]], "Input",
 NumberMarks->False],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", "G", " ", "\[Pi]", " ", 
   SubsuperscriptBox["R", "s", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"Log", "[", 
       SubscriptBox["R", "s"], "]"}]}], "+", 
     RowBox[{"Log", "[", 
      RowBox[{"r", "+", 
       SubscriptBox["R", "s"]}], "]"}], "-", 
     FractionBox["r", 
      RowBox[{"r", "+", 
       SubscriptBox["R", "s"]}]]}], ")"}], " ", 
   SubscriptBox["\[Rho]", "s"]}], 
  SuperscriptBox["r", "2"]]], "Output",
 CellChangeTimes->{3.834758202181018*^9}]
}, Open  ]],

Cell["Second derivative of potential", "Text",
 CellChangeTimes->{{3.8683898196654825`*^9, 3.86838982309807*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"\[Phi]", "''"}], "[", "r", "]"}]], "Input",
 CellChangeTimes->{{3.86838976430184*^9, 3.868389793925949*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"8", " ", "G", " ", "\[Pi]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Log", "[", 
       SubscriptBox["R", "s"], "]"}], "-", 
      RowBox[{"Log", "[", 
       RowBox[{"r", "+", 
        SubscriptBox["R", "s"]}], "]"}]}], ")"}], " ", 
    SubsuperscriptBox["R", "s", "3"], " ", 
    SubscriptBox["\[Rho]", "s"]}], 
   SuperscriptBox["r", "3"]], "+", 
  FractionBox[
   RowBox[{"4", " ", "G", " ", "\[Pi]", " ", 
    SubsuperscriptBox["R", "s", "3"], " ", 
    SubscriptBox["\[Rho]", "s"]}], 
   RowBox[{"r", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"r", "+", 
       SubscriptBox["R", "s"]}], ")"}], "2"]}]], "+", 
  FractionBox[
   RowBox[{"8", " ", "G", " ", "\[Pi]", " ", 
    SubsuperscriptBox["R", "s", "3"], " ", 
    SubscriptBox["\[Rho]", "s"]}], 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"r", "+", 
      SubscriptBox["R", "s"]}], ")"}]}]]}]], "Output",
 CellChangeTimes->{{3.86838976556504*^9, 3.8683898010288196`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   FractionBox[
    RowBox[{"8", " ", "G", " ", "\[Pi]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Log", "[", 
        SubscriptBox["R", "s"], "]"}], "-", 
       RowBox[{"Log", "[", 
        RowBox[{"r", "+", 
         SubscriptBox["R", "s"]}], "]"}]}], ")"}], " ", 
     SubsuperscriptBox["R", "s", "3"], " ", 
     SubscriptBox["\[Rho]", "s"]}], 
    SuperscriptBox["r", "3"]], "+", 
   FractionBox[
    RowBox[{"4", " ", "G", " ", "\[Pi]", " ", 
     SubsuperscriptBox["R", "s", "3"], " ", 
     SubscriptBox["\[Rho]", "s"]}], 
    RowBox[{"r", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"r", "+", 
        SubscriptBox["R", "s"]}], ")"}], "2"]}]], "+", 
   FractionBox[
    RowBox[{"8", " ", "G", " ", "\[Pi]", " ", 
     SubsuperscriptBox["R", "s", "3"], " ", 
     SubscriptBox["\[Rho]", "s"]}], 
    RowBox[{
     SuperscriptBox["r", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"r", "+", 
       SubscriptBox["R", "s"]}], ")"}]}]]}], "]"}]], "Input",
 CellChangeTimes->{{3.868389805762932*^9, 3.8683898107103033`*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"4", " ", "G", " ", "\[Pi]", " ", 
   SubsuperscriptBox["R", "s", "3"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"Log", "[", 
       SubscriptBox["R", "s"], "]"}]}], "-", 
     RowBox[{"2", " ", 
      RowBox[{"Log", "[", 
       RowBox[{"r", "+", 
        SubscriptBox["R", "s"]}], "]"}]}], "+", 
     FractionBox[
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", "r"}], "+", 
         RowBox[{"2", " ", 
          SubscriptBox["R", "s"]}]}], ")"}]}], 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"r", "+", 
         SubscriptBox["R", "s"]}], ")"}], "2"]]}], ")"}], " ", 
   SubscriptBox["\[Rho]", "s"]}], 
  SuperscriptBox["r", "3"]]], "Output",
 CellChangeTimes->{3.8683898112397223`*^9}]
}, Open  ]]
},
WindowSize->{808, 911},
WindowMargins->{{370, Automatic}, {Automatic, 42}},
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 170, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[753, 28, 403, 11, 48, "Input"],
Cell[1159, 41, 762, 24, 45, "Output"]
}, Open  ]],
Cell[1936, 68, 123, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[2084, 73, 1214, 37, 53, "Input"],
Cell[3301, 112, 1051, 32, 73, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4389, 149, 1297, 39, 53, "Input"],
Cell[5689, 190, 3237, 99, 173, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8963, 294, 3401, 101, 196, "Input"],
Cell[12367, 397, 2783, 84, 149, "Output"]
}, Open  ]],
Cell[15165, 484, 273, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[15463, 494, 695, 20, 71, "Input"],
Cell[16161, 516, 800, 24, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16998, 545, 143, 3, 30, "Input"],
Cell[17144, 550, 744, 23, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17925, 578, 778, 24, 55, "Input"],
Cell[18706, 604, 548, 17, 59, "Output"]
}, Open  ]],
Cell[19269, 624, 113, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[19407, 629, 143, 3, 30, "Input"],
Cell[19553, 634, 1047, 32, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20637, 671, 1112, 33, 55, "Input"],
Cell[21752, 706, 818, 26, 59, "Output"]
}, Open  ]]
}
]
*)

